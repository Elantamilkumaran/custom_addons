<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- =====================================================
                        TREE VIEW
    ====================================================== -->
    <record id="view_student_tree" model="ir.ui.view">
        <field name="name">student.management.list</field>
        <field name="model">student.management</field>
        <field name="arch" type="xml">
            <list>
                <field name="image_1920"
                       widget="image"
                       class="oe_avatar"
                       options="{'size': [40, 40]}"/>

                <field name="name"/>
                <field name="age"/>
                <field name="course"/>
                <field name="year_stage"/>
                <field name="total_marks"/>

                <field name="grade"
                       widget="badge"
                       decoration-primary="grade == 'outstanding'"
                       decoration-success="grade == 'excellent'"
                       decoration-info="grade == 'good'"
                       decoration-danger="grade == 'fail'"/>
            </list>
        </field>
    </record>

    <!-- =====================================================
                        FORM VIEW
    ====================================================== -->
    <record id="view_student_form" model="ir.ui.view">
        <field name="name">student.management.form</field>
        <field name="model">student.management</field>
        <field name="arch" type="xml">
            <form>

                <!-- ===== YEAR STAGE BAR & BUTTONS ===== -->
                <header>
                    <field name="year_stage"
                           widget="statusbar"
                           statusbar_visible="year1,year2,year3,year4"/>

                    <button name="action_prev_year"
                            type="object"
                            string="Previous Year"
                            class="btn-secondary"
                            invisible="year_stage == 'year1'"/>

                    <button name="action_next_year"
                            type="object"
                            string="Next Year"
                            class="btn-primary"
                            invisible="year_stage == 'year4'"/>
                </header>

                <sheet>

                    <!-- IMAGE + BASIC DETAILS -->
                    <group>
                        <group>
                            <field name="image_1920"
                                   widget="image"
                                   class="oe_avatar"
                                   options="{'preview_image': 'image_1920'}"/>
                        </group>

                        <group string="Student Details">
                            <field name="name"/>
                            <field name="age"/>
                            <field name="course"/>
                            <field name="year_stage" readonly="1"/>
                        </group>
                    </group>

                    <!-- ================= NOTEBOOK ================= -->
                    <notebook>

                        <!-- MARKS TAB -->
                        <page string="Marks">
                            <group>
                                <field name="internal_marks"/>
                                <field name="external_marks"/>
                                <field name="total_marks" readonly="1"/>
                            </group>

                            <group string="Result">
                                <field name="grade" readonly="1"/>
                            </group>
                        </page>

                        <!-- SKILLS TAB -->
                        <page string="Skills">
                            <field name="skill_ids">
                                <list editable="bottom">
                                    <field name="name"/>
                                    <field name="level"/>
                                </list>
                            </field>
                        </page>

                    </notebook>

                </sheet>
            </form>
        </field>
    </record>

    <!-- =====================================================
                        SEARCH VIEW
    ====================================================== -->
    <record id="view_student_search" model="ir.ui.view">
        <field name="name">student.management.search</field>
        <field name="model">student.management</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="course"/>
                <field name="year_stage"/>

                <filter name="filter_year1"
                        string="1st Year"
                        domain="[('year_stage','=','year1')]"/>

                <filter name="filter_fail"
                        string="Fail"
                        domain="[('grade','=','fail')]"/>
            </search>
        </field>
    </record>

    <!-- =====================================================
                        ACTION
    ====================================================== -->
    <record id="action_student" model="ir.actions.act_window">
        <field name="name">Students</field>
        <field name="res_model">student.management</field>
        <field name="view_mode">list,form</field>
        <field name="search_view_id" ref="view_student_search"/>
    </record>

    <!-- =====================================================
                        MENU
    ====================================================== -->
    <menuitem id="menu_student_root" name="Student Management"/>

    <menuitem id="menu_student"
              name="Students"
              parent="menu_student_root"
              action="action_student"/>

</odoo>
